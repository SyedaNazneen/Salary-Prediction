# -*- coding: utf-8 -*-
"""SLR.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KoCCc5HtxpvFy768jB71FCVtnkzBKWb9
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

df=pd.read_csv('/content/Salary_Data.csv')

df

X=df[['YearsExperience']]
y=df['Salary']

X

y

"""# Training"""

import sklearn
from sklearn.model_selection import train_test_split

X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)

len(X_train),len(y_train)

len(X_test),len(y_test)

X_train

y_train

plt.figure(figsize=(5,3))
plt.title('training data')
plt.scatter(x=X_train,y=y_train,color='r',marker='*')
plt.show()

training_data=pd.DataFrame({
    'X_train_values':X_train.to_numpy().ravel(),
    'y_train_values':y_train
})

training_data

testing_data=pd.DataFrame({
    'X_test_values':X_test.to_numpy().ravel(),
    'y_test_values':y_test
})

testing_data

from sklearn.linear_model import LinearRegression
reg=LinearRegression()
reg.fit(X_train,y_train)

reg.coef_

reg.intercept_

"""model(y=mX+c)"""

#9423.81532303*10.3	+25321.583011776813

predictions=reg.predict(X_train)

predictions

training_data['model_predictions']=predictions

training_data

plt.figure(figsize=(5,3))
plt.title('training data')
plt.scatter(x=X_train,y=y_train,color='r',marker='*')
plt.plot(X_train,predictions,color='g',marker='s')
plt.show()

from sklearn.metrics import r2_score
r2_score(y_train,predictions)

0.9883793806283427*100

s=0
for i in training_data.index:
  s=s+(training_data['y_train_values'][i]-training_data['model_predictions'][i])
print(s)

from sklearn.metrics import mean_squared_error
print(f'Training loss Values : {mean_squared_error(y_train,predictions)}')

numerator=0
denominator=0
for i in training_data.index:
  numerator=numerator+(training_data['y_train_values'][i]-training_data['model_predictions'][i])**2
  denominator=denominator+(training_data['y_train_values'][i]-training_data.mean())**2

print(f'Training Accuracy :{1-(numerator)/denominator}')

from sklearn.metrics import r2_score
r2_score(y_train,predictions)

testing_data

model_ans=reg.predict(X_test)
model_ans

testing_data['model_test_prediction']=model_ans

testing_data

print(f'Testing Loss :{mean_squared_error(y_test,model_ans)}')

print(f'Accuracy :{r2_score(y_test,model_ans)}')

import pickle

with open('SLR.pkl','wb') as f:
  pickle.dump(reg,f)

with open('SLR.pkl','rb') as f:
  m=pickle.load(f)

import warnings
warnings.filterwarnings('ignore')

m.predict([[10]])

